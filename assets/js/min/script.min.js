var offalApp={};offalApp.searchResults=$(".results").find("ul"),offalApp.apiId="14f4d8e5",offalApp.apiKey="5e222f130215043a2133fcb7e77788b6",offalApp.init=function(){offalApp.filterParts(),$("#searchButton").on("click",function(e){e.preventDefault(),$("#results").fadeIn(400);var a=offalApp.getAnimal(),t=offalApp.getPart();a&&t?(offalApp.searchResults.empty(),offalApp.getSearchResults(a,t),$("#chooseAnimal").css("border","none").find("h2").text("Step 1: Choose an Animal").removeClass("alert").remove("i.fa-exclamation-circle"),$("#choosePart").css("border","none").find("h2").text("Step 2: Pick your offal").removeClass("alert").remove("i.fa-exclamation-circle"),$("button.rated, button.quickest, button.meaty").removeClass("currentFilter"),$("button.all").addClass("currentFilter"),$.smoothScroll({scrollTarget:"#results",speed:800}),$(document).scroll(function(){var e=$(this).scrollTop(),a=$("#results").position();e>a.top-50?$("#filters").addClass("fixed"):$("#filters").removeClass("fixed")})):a&&!t?($("#choosePart").css("border","5px solid #a50000").find("h2").text("Don't forget the offal").addClass("alert").prepend($('<i class="fa fa-exclamation-circle"></i>').addClass("alert").css({position:"relative",left:"-20px"})),$.smoothScroll({scrollTarget:"#choosePart",speed:400,offset:-20}),$("#results").hide()):($("#chooseAnimal").css("border","5px solid #a50000").find("h2").text("Choose an animal").addClass("alert").prepend($('<i class="fa fa-exclamation-circle"></i>').addClass("alert").css({position:"relative",left:"-20px"})),$.smoothScroll({scrollTarget:"#chooseAnimal",speed:400,offset:-20}),$("#results").hide())})},offalApp.filterParts=function(){$("input[value=chicken]").on("click",function(){$(".choosePart").find("label, input, p").css("display","none"),$("label.heart, label.liver, label.feet, label.gizzard").css({display:"block",width:"21%"}),$.smoothScroll({scrollTarget:"#choosePart",speed:900})}),$("input[value=beef]").on("click",function(){$(".choosePart").find("label, input, p").css("display","none"),$("label.liver, label.tripe, label.marrow").css({display:"block",width:"29.3333%"}),$.smoothScroll({scrollTarget:"#choosePart",speed:900})}),$("input[value=lamb]").on("click",function(){$(".choosePart").find("label, input, p").css("display","none"),$("label.liver, label.brain").css({display:"block",width:"46%"}),$.smoothScroll({scrollTarget:"#choosePart",speed:900})}),$("input[value=pig]").on("click",function(){$(".choosePart").find("label, input, p").css("display","none"),$("label.tail, label.feet, label.ear").css({display:"block",width:"29.3333%"}),$.smoothScroll({scrollTarget:"#choosePart",speed:900})})},offalApp.getAnimal=function(){var e=$("fieldset#chooseAnimal").find(":checked").val();return console.log(e),e},offalApp.getPart=function(){var e=$("fieldset#choosePart").find(":checked").val();return console.log(e),e},offalApp.getSearchResults=function(e,a){"lamb"==e&&"brain"==a?$.ajax({url:"https://api.yummly.com/v1/api/recipes",type:"GET",dataType:"jsonp",data:{format:"jsonp",_app_id:offalApp.apiId,_app_key:offalApp.apiKey,q:"lamb brain"},success:function(e){console.log(e),offalApp.displaySearchResults(e.matches)}}):"beef"==e&&"tripe"==a?$.ajax({url:"https://api.yummly.com/v1/api/recipes",type:"GET",dataType:"jsonp",data:{format:"jsonp",_app_id:offalApp.apiId,_app_key:offalApp.apiKey,q:"beef tripe"},success:function(e){console.log(e),offalApp.displaySearchResults(e.matches)}}):"beef"==e&&"marrow"==a?$.ajax({url:"https://api.yummly.com/v1/api/recipes",type:"GET",dataType:"jsonp",data:{format:"jsonp",_app_id:offalApp.apiId,_app_key:offalApp.apiKey,q:"beef marrow"},success:function(e){console.log(e),offalApp.displaySearchResults(e.matches)}}):$.ajax({url:"https://api.yummly.com/v1/api/recipes",type:"GET",dataType:"jsonp",data:{format:"jsonp",_app_id:offalApp.apiId,_app_key:offalApp.apiKey,q:e+"+"+a,allowedIngredient:e+" "+a},success:function(e){console.log(e),offalApp.searchResults.empty(),offalApp.displaySearchResults(e.matches)}})},offalApp.displaySearchResults=function(e){$.each(e,function(e,a){var t=a.id,l=$("<h3>").text(a.recipeName);console.log(a.recipeName);var o=$("<h4>").text("Recipe from "+a.sourceDisplayName);console.log(a.sourceDisplayName);var s=$("<h5>").text("Rating: "+a.rating+"/5");console.log(a.rating);var r=a.totalTimeInSeconds;if(r/60>100)var i=$("<h5>").text("Ready in "+Math.round(r/60/60)+" hours");else if(r/60==0)var i="";else var i=$("<h5>").text("Ready in "+r/60+" minutes");console.log(i);{var n=$("<a>").attr({href:"http://www.yummly.com/recipe/"+t,target:"_blank"});a.flavors}if(a.flavors)var c=a.flavors.meaty;var p=$("<span>").addClass("primary").append(l,o),f=$("<span>").addClass("secondary").append(i,s);if(a.hasOwnProperty("smallImageUrls")){var u=a.smallImageUrls.toString().replace("=s90","");console.log(u);var d=$("<img>").attr("src",u)}else var d=$("<img>").attr("src","assets/images/noImage.png");var m=$("<div>").addClass("recipeImage").append(d),h=n.append(m,p,f),g=$("<li>").addClass("recipe clearfix").append(h);a.rating>=4&&g.addClass("highestRated"),30>=r/60&&g.addClass("quick"),c>.1666&&g.addClass("meaty"),offalApp.searchResults.append(g)}),$("footer").show()},$(function(){document.forms.userOptions.reset(),offalApp.init(),$("#results").hide(),$("footer").hide(),$("#showOptions").on("click",function(){$("header").fadeOut(800),$("#userOptions").show()}),$("#home").on("click",function(){$("header").fadeIn(800)}),$("filter button").on("click",function(e){e.preventDefault()}),$("button.rated").on("click",function(){$(this).toggleClass("currentFilter"),$(".results li:not(.highestRated)").toggle(),$("button.all").removeClass("currentFilter")}),$("button.quickest").on("click",function(){$(this).toggleClass("currentFilter"),$(".results li:not(.quick)").toggle(),$("button.all").removeClass("currentFilter")}),$("button.meaty").on("click",function(){$(this).toggleClass("currentFilter"),$(".results li:not(.meaty)").toggle(),$("button.all").removeClass("currentFilter")}),$("button.all").on("click",function(){$(this).toggleClass("currentFilter"),$("button.rated, button.quickest, button.meaty").removeClass("currentFilter"),$(".results li").show()}),$("#scrollToFirst").on("click",function(){$.smoothScroll({scrollTarget:"#results",speed:600})}),$("#newSearch").on("click",function(){$("button.rated, button.quickest, button.meaty").removeClass("currentFilter"),document.forms.userOptions.reset(),$.smoothScroll({scrollTarget:"#userOptions",speed:600,offset:130})})});